<!DOCTYPE html>
<html lang="en">
    <head>
        <title> HW5Part1</title>
    </head>

    <body>
        <header>
            <h1>hw5Part1</h1>
            <!-- post: insert data -->
            <button id="post">postBtn</button>
            <!-- get: read data -->
            <button id="get">getBtn</button>
            <!-- put: update data, or insert if a new id -->
            <button id="put">putBtn</button>
            <!-- delete: delete data -->
            <button id="delete">deleteBtn</button>
        </header>

        <main>
            <p>The response is: </p>
            <textarea id="response" rows="50" cols="100"></textarea>
        </main>
    </body>

    <script type="module">
        const postBtn = document.getElementById('post')
        const getBtn = document.getElementById('get')
        const putBtn = document.getElementById('put')
        const deleteBtn = document.getElementById('delete')

        const postUrl = 'https://httpbin.org/post';
        const getUrl = 'https://httpbin.org/get';
        const putUrl = 'https://httpbin.org/put';
        const deleteUrl = 'https://httpbin.org/delete';

        var data = {};
        data.id = "";
        data.article_name = "";
        data.article_body = "";
        data.date = "";

        postBtn.addEventListener('click', ()=> {
            data.id = "010101";
            data.article_name = "aaaaa";
            data.article_body = "bbbbb";
            data.date = new Date().toLocaleDateString("en-US");

            var json = JSON.stringify(data);

            const xhr = new XMLHttpRequest();
            xhr.open('POST', postUrl, true);
            xhr.setRequestHeader('Content-type','application/json; charset=utf-8');
            xhr.onreadystatechange = function() {
                console.log(xhr.responseText);
                document.getElementById('response').innerHTML = this.responseText;
            };
            
            xhr.send(json);

        });

        getBtn.addEventListener('click', ()=> {
            const xhr = new XMLHttpRequest();
            xhr.open('Get', getUrl, true);
            xhr.onreadystatechange = function() {
                console.log(xhr.responseText);
                document.getElementById('response').innerHTML = this.responseText;
            };  
            xhr.send();

        });

        putBtn.addEventListener('click', ()=> {
            data.id = "222222222";
            data.article_name = "ccccc";
            data.article_body = "dddddddd";
            data.date = new Date().toLocaleDateString("en-US");
            
            var json = JSON.stringify(data);

            const xhr = new XMLHttpRequest();
            xhr.open('Put', putUrl, true);
            xhr.setRequestHeader('Content-type','application/json; charset=utf-8');
            xhr.onreadystatechange = function() {
                console.log(xhr.responseText);
                document.getElementById('response').innerHTML = this.responseText;
            };  
            xhr.send(json);

        });

        deleteBtn.addEventListener('click', ()=> {
            const xhr = new XMLHttpRequest();
            xhr.open('Delete', deleteUrl, true);
            xhr.onreadystatechange = function() {
                console.log(xhr.responseText);
                document.getElementById('response').innerHTML = this.responseText;
            };  
            xhr.send();

        });
    </script>
</html>